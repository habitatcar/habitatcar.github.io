<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Registro - Habitat-Car</title>
</head>
<body style="font-family: sans-serif; padding: 20px; max-width: 600px; margin: 0 auto;">
  <h2>ğŸ“ Registro de Beneficios</h2>
  <input id="nombre" placeholder="Nombre y Apellido" style="width:100%; padding:10px; margin:10px 0;" required><br>
  <input id="whatsapp" placeholder="WhatsApp (ej: 3884618228)" style="width:100%; padding:10px; margin:10px 0;" required><br>
  <input id="email" placeholder="Email (opcional)" type="email" style="width:100%; padding:10px; margin:10px 0;"><br>
  <button onclick="registrar()" style="width:100%; padding:12px; background:#2c5aa0; color:white; border:none; font-size:18px;">
    Activar mis beneficios
  </button>
  <div id="mensaje" style="margin-top:20px; font-weight:bold;"></div>

  <script>
    // â¬‡ï¸ PEGÃ TU URL AQUÃ â¬‡ï¸
    const URL_WEB_APP = "https://script.google.com/macros/s/AKfycbz1salSEcSL7EzrUvw0OlXNCnHI14yo62MpVEHZBw4-AOT2GcOXwSK1NtvTxgTj-wFa/exec
";

    async function registrar() {
      const n = document.getElementById('nombre').value.trim();
      const w = document.getElementById('whatsapp').value.replace(/\D/g,'');
      const e = document.getElementById('email').value.trim();

      if (!n || !w) { alert("CompletÃ¡ nombre y WhatsApp"); return; }

      try {
        const r = await fetch(URL_WEB_APP + "?accion=registrarLead&nombre=" + encodeURIComponent(n) + "&whatsapp=" + w + "&email=" + encodeURIComponent(e));
        const d = await r.json();
        if (d.success) {
          document.getElementById('mensaje').innerHTML = 'âœ… Â¡Listo! Redirigiendo...';
          localStorage.setItem('usuarioHabitatCar', JSON.stringify({nombre:n, whatsapp:w, email:e, tipo:'lead'}));
          setTimeout(() => window.location.href = "/cupones/", 1500);
        } else {
          alert("Error. Intentalo mÃ¡s tarde.");
        }
      } catch (err) {
        alert("Sin conexiÃ³n a internet.");
      }
    }
  </script>
</body>
</html>
