<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Beneficios Habitat-Car</title>
  <script src="https://unpkg.com/@zxing/library@0.18.3/umd/index.min.js"></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #f8f9fa;
      padding: 20px 16px;
      font-size: 22px;
      line-height: 1.5;
    }
    .container { max-width: 600px; margin: 0 auto; }
    .logo { width: 98%; max-width: 520px; display: block; margin: 0 auto 20px; }
    .titulo { color: #2c5aa0; font-size: 32px; text-align: center; font-weight: bold; margin-bottom: 10px; }
    #subtitulo { text-align: center; color: #d4af37; font-size: 22px; font-weight: bold; margin-bottom: 15px; display: none; }

    .botones-superiores { display: flex; gap: 15px; margin-bottom: 25px; }
    .botones-superiores .btn { flex: 1; padding: 14px; font-size: 18px; }
    .btn-curioso { background: #ff9800; color: white; }
    .btn-tutorial { background: #03a9f4; color: white; }

    body.vip { background: #fffaf0; }
    body.vip .titulo, body.vip #subtitulo { color: #d4af37; text-shadow: 1px 1px 2px rgba(0,0,0,0.1); }
    body.vip .cupon { border: 2px solid #d4af37; background: white; }
    body.vip .btn-usar:not(:disabled) { background: #d4af37 !important; color: white !important; }
    body.vip .btn-conozca, body.vip .btn-como-llegar, body.vip .btn-qr { background: #d4af37 !important; color: white !important; }

    .cupon { background: white; border-radius: 20px; padding: 25px 20px; margin: 30px 0; box-shadow: 0 5px 18px rgba(0,0,0,0.1); }
    .recuadro-comercio { background: white; border-radius: 16px; padding: 20px; margin-bottom: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: center; }
    .recuadro-comercio img { max-width: 100%; height: auto; margin: 0 auto 15px; display: block; }
    .recuadro-comercio .nombre-comercio { font-size: 28px; font-weight: bold; color: #2c5aa0; margin: 0; }

    .cupon.inactivo { background: #e0e0e0 !important; opacity: 1 !important; filter: grayscale(30%) brightness(90%); }
    .descuento { font-size: 24px; margin: 12px 0; font-weight: bold; color: #2c5aa0; text-align: center; }
    body.vip .descuento { color: #d4af37; }

    .info { margin: 12px 0; font-size: 20px; line-height: 1.4; }
    .btn { display: block; width: 100%; padding: 16px; border-radius: 16px; font-size: 20px; font-weight: bold; text-align: center; text-decoration: none; cursor: pointer; margin-top: 12px; border: none; }

    .btn-conozca { background: #9c27b0; color: white; }
    .btn-como-llegar { background: #4CAF50; color: white; }
    .btn-qr { background: #E91E63; color: white; }
    .btn-usar { background: #2c5aa0; color: white; }
    .btn:disabled { background: #cccccc !important; color: #666666 !important; cursor: not-allowed; box-shadow: none; }

    .aviso-validado {
      position: fixed; top: 20%; left: 50%; transform: translateX(-50%);
      width: 90%; max-width: 450px; background: #2e7d32; color: white;
      padding: 30px; border-radius: 25px; text-align: center; z-index: 10001;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3); border: 4px solid #fff;
    }

    #mensaje-error-global {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #1976d2;
      border: 4px solid #d32f2f;
      color: white;
      padding: 24px 30px;
      border-radius: 20px;
      font-size: 22px;
      font-weight: bold;
      text-align: center;
      z-index: 10000;
      box-shadow: 0 10px 30px rgba(0,0,0,0.5);
      max-width: 90%;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    #mensaje-error-global.mostrar {
      opacity: 1;
      pointer-events: auto;
    }

    #mensaje-error-global::before {
      content: "‚ùå";
      display: block;
      font-size: 52px;
      color: #d32f2f;
      text-shadow: 0 0 8px white;
      margin-bottom: 14px;
    }

    .qr-scanner { position: fixed; inset: 0; background: rgba(0,0,0,0.95); display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 9999; padding: 20px; }
    .qr-scanner video { width: 90%; max-width: 500px; border: 2px dashed #fff; border-radius: 12px; }
    .close-btn { background: #d32f2f; color: white; border: none; border-radius: 12px; padding: 14px 28px; font-size: 18px; margin-top: 15px; }
  </style>
</head>

<body id="body">

<div class="container">
  <img src="/logo.png" class="logo">
  <div class="titulo">üéÅ Tus beneficios Habitat-Car</div>
  <div id="subtitulo"></div>
  <div id="grilla"></div>
</div>

<div id="mensaje-error-global"></div>

<script>
let errorTimeout = null;

function mostrarErrorGlobal(mensaje) {
  const errorDiv = document.getElementById('mensaje-error-global');

  if (errorTimeout) clearTimeout(errorTimeout);

  errorDiv.innerHTML = mensaje;
  errorDiv.classList.add('mostrar');

  errorTimeout = setTimeout(() => {
    errorDiv.classList.remove('mostrar');
    errorDiv.innerHTML = '';
  }, 3000);
}
</script>

</body>
</html>
