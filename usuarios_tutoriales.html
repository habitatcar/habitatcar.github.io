<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CÃ³mo utilizar tus cupones | HÃ¡bitat-Car</title>
    <style>
        :root { 
            --azul-oscuro: #0a192f; 
            --azul-medio: #334766; 
            --oro: #ffc107; 
            --blanco: #e6f1ff; 
            --celeste-habitat: #004a99;
        }
        body { 
            font-family: 'Segoe UI', sans-serif; 
            background-color: var(--azul-oscuro); 
            color: var(--blanco); 
            margin: 0; text-align: center; 
        }
        
        /* HEADER */
        .header { padding: 40px 20px 20px 20px; }
        
        /* LOGO CON AUMENTO REAL DEL 25% (400px) */
        .logo-grande { 
            width: 400px; 
            max-width: 95%; 
            height: auto; 
            margin-bottom: 25px; 
            display: inline-block;
        }

        h1 { color: var(--oro); font-size: 2.2em; margin-bottom: 10px; }
        
        .btn-volver {
            display: inline-block; 
            padding: 15px 45px; 
            background: var(--celeste-habitat); 
            color: white; 
            border-radius: 50px; 
            font-weight: bold; 
            margin-bottom: 30px; 
            transition: 0.3s; 
            cursor: pointer; 
            border: none; 
            font-size: 18px;
            text-transform: uppercase;
        }
        .btn-volver:hover { background: var(--oro); color: var(--azul-oscuro); }

        /* CONTROLES Y GRID */
        .controls { margin-bottom: 30px; display: flex; justify-content: center; gap: 10px; }
        .btn-view { 
            background: var(--azul-medio); border: none; color: white; padding: 10px 20px; 
            border-radius: 5px; cursor: pointer; font-weight: bold;
        }
        .btn-view.active { background: var(--oro); color: var(--azul-oscuro); }

        .grid { display: grid; gap: 20px; padding: 20px; max-width: 1200px; margin: 0 auto; }
        .view-grid { grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); }
        .view-list { grid-template-columns: 1fr; max-width: 800px; }

        .card { 
            background: var(--azul-medio); border-radius: 15px; overflow: hidden; 
            border: 1px solid rgba(255,255,255,0.1); text-align: left;
        }
        .thumb-container { position: relative; cursor: pointer; background: black; height: 180px; }
        .thumb { width: 100%; height: 100%; object-fit: cover; opacity: 0.8; }
        .play-hint { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 50px; color: var(--oro); }

        .card-body { padding: 20px; }
        .btn-accion { display: block; text-align: center; background: var(--oro); color: var(--azul-oscuro); text-decoration: none; padding: 10px; border-radius: 8px; font-weight: bold; }

        @media (max-width: 600px) {
            .logo-grande { width: 320px; }
        }
    </style>
</head>
<body>

    <div class="header">
        <img src="https://github.com/habitatcar/habitatcar.github.io/blob/main/logo.png?raw=true" class="logo-grande">
        <h1>Centro de Ayuda</h1>
        <p>Aprende a sacar el mÃ¡ximo provecho de tus beneficios</p>
        
        <button onclick="window.history.back()" class="btn-volver">VOLVER</button>
    </div>

    <div class="controls">
        <button class="btn-view active" id="btnGrid" onclick="changeView('grid')">CuadrÃ­cula</button>
        <button class="btn-view" id="btnList" onclick="changeView('list')">Lista</button>
    </div>

    <div id="grid-tutoriales" class="grid view-grid"></div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, collection, query, orderBy, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyD5M0kPsdU8Hk_YX3uEahfoQ5k9PD8SUXM",
            authDomain: "habitatcar-pro.firebaseapp.com",
            projectId: "habitatcar-pro",
            storageBucket: "habitatcar-pro.firebasestorage.app",
            messagingSenderId: "311691258694",
            appId: "1:311691258694:web:17a09051dcea7707af9347"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        window.changeView = (type) => {
            const grid = document.getElementById('grid-tutoriales');
            const btnGrid = document.getElementById('btnGrid');
            const btnList = document.getElementById('btnList');
            grid.className = type === 'grid' ? "grid view-grid" : "grid view-list";
            btnGrid.classList.toggle('active', type === 'grid');
            btnList.classList.toggle('active', type === 'list');
        };

        const q = query(collection(db, "tutoriales"), orderBy("fecha", "desc"));
        onSnapshot(q, (snap) => {
            const container = document.getElementById('grid-tutoriales');
            container.innerHTML = "";
            snap.forEach(doc => {
                const t = doc.data();
                const label = t.tipo === 'video' ? 'VER VIDEO' : 'VER PDF';
                container.innerHTML += `
                    <div class="card">
                        <div class="thumb-container" onclick="window.open('${t.url}', '_blank')">
                            <img src="${t.preview || ''}" class="thumb">
                            <div class="play-hint">${t.tipo === 'video' ? 'â–¶' : 'ðŸ“„'}</div>
                        </div>
                        <div class="card-body">
                            <h3>${t.titulo}</h3>
                            <a href="${t.url}" target="_blank" class="btn-accion">${label}</a>
                        </div>
                    </div>`;
            });
        });
    </script>
</body>
</html>
